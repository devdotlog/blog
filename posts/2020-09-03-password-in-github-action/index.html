<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Github Action을 이용한 빌드 & 실행에서 패스워드 숨기기</title><meta name=description content="뭘 좀 남기자. 맨날 똑같은거 또 찾고."><meta name=naver-site-verification content="bcf371eb4e5b9977f8fcc0116a87d622e88abb85"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Github Action을 이용한 빌드 & 실행에서 패스워드 숨기기"><meta property="og:description" content="Github Actions? Github에는 Actions라는 기능이 있습니다. Travis CI 처럼 소스코드를 이용해서 build, test, deploy 등의 기능을 수행할 수 있는 서비스입니다.
Github Actions을 이용하면 hugo blog 빌드 & 배포, cron을 이용한 반복적인 업무 자동화도 할 수 있습니다.
Github Actions을 이용해서 DB 데이터 업데이트하기 만약에 일주일에 한번씩 DB를 업데이트 해야하는 일이 있다고 가정합니다.
 사용하는 DB용 클라이언트를 실행 login/password로 로그인 업데이트 query를 수행하기 위한 데이터 확인 Query를 실행 잊지 않고 정해진 요일에 반복 수행  아마도 개발자는 위와 같은 단계를 반복적으로 수행하게 됩니다."><meta property="og:type" content="article"><meta property="og:url" content="https://sh0seo.github.io/posts/2020-09-03-password-in-github-action/"><meta property="article:published_time" content="2020-09-03T14:35:00+09:00"><meta property="article:modified_time" content="2020-09-03T14:35:00+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Github Action을 이용한 빌드 & 실행에서 패스워드 숨기기"><meta name=twitter:description content="Github Actions? Github에는 Actions라는 기능이 있습니다. Travis CI 처럼 소스코드를 이용해서 build, test, deploy 등의 기능을 수행할 수 있는 서비스입니다.
Github Actions을 이용하면 hugo blog 빌드 & 배포, cron을 이용한 반복적인 업무 자동화도 할 수 있습니다.
Github Actions을 이용해서 DB 데이터 업데이트하기 만약에 일주일에 한번씩 DB를 업데이트 해야하는 일이 있다고 가정합니다.
 사용하는 DB용 클라이언트를 실행 login/password로 로그인 업데이트 query를 수행하기 위한 데이터 확인 Query를 실행 잊지 않고 정해진 요일에 반복 수행  아마도 개발자는 위와 같은 단계를 반복적으로 수행하게 됩니다."><link rel=stylesheet href=https://sh0seo.github.io/css/style-classic.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://sh0seo.github.io/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about/>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://sh0seo.github.io/posts/2020-09-01-text-normalization-in-go/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&text=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&is_video=false&description=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0&body=Check out this article: https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&name=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0&description=Github%20Actions%3f%20Github%ec%97%90%eb%8a%94%20Actions%eb%9d%bc%eb%8a%94%20%ea%b8%b0%eb%8a%a5%ec%9d%b4%20%ec%9e%88%ec%8a%b5%eb%8b%88%eb%8b%a4.%20Travis%20CI%20%ec%b2%98%eb%9f%bc%20%ec%86%8c%ec%8a%a4%ec%bd%94%eb%93%9c%eb%a5%bc%20%ec%9d%b4%ec%9a%a9%ed%95%b4%ec%84%9c%20build%2c%20test%2c%20deploy%20%eb%93%b1%ec%9d%98%20%ea%b8%b0%eb%8a%a5%ec%9d%84%20%ec%88%98%ed%96%89%ed%95%a0%20%ec%88%98%20%ec%9e%88%eb%8a%94%20%ec%84%9c%eb%b9%84%ec%8a%a4%ec%9e%85%eb%8b%88%eb%8b%a4.%0aGithub%20Actions%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%98%eb%a9%b4%20hugo%20blog%20%eb%b9%8c%eb%93%9c%20%26amp%3b%20%eb%b0%b0%ed%8f%ac%2c%20cron%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b0%98%eb%b3%b5%ec%a0%81%ec%9d%b8%20%ec%97%85%eb%ac%b4%20%ec%9e%90%eb%8f%99%ed%99%94%eb%8f%84%20%ed%95%a0%20%ec%88%98%20%ec%9e%88%ec%8a%b5%eb%8b%88%eb%8b%a4.%0aGithub%20Actions%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%b4%ec%84%9c%20DB%20%eb%8d%b0%ec%9d%b4%ed%84%b0%20%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8%ed%95%98%ea%b8%b0%20%eb%a7%8c%ec%95%bd%ec%97%90%20%ec%9d%bc%ec%a3%bc%ec%9d%bc%ec%97%90%20%ed%95%9c%eb%b2%88%ec%94%a9%20DB%eb%a5%bc%20%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8%20%ed%95%b4%ec%95%bc%ed%95%98%eb%8a%94%20%ec%9d%bc%ec%9d%b4%20%ec%9e%88%eb%8b%a4%ea%b3%a0%20%ea%b0%80%ec%a0%95%ed%95%a9%eb%8b%88%eb%8b%a4.%0a%20%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94%20DB%ec%9a%a9%20%ed%81%b4%eb%9d%bc%ec%9d%b4%ec%96%b8%ed%8a%b8%eb%a5%bc%20%ec%8b%a4%ed%96%89%20login%2fpassword%eb%a1%9c%20%eb%a1%9c%ea%b7%b8%ec%9d%b8%20%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8%20query%eb%a5%bc%20%ec%88%98%ed%96%89%ed%95%98%ea%b8%b0%20%ec%9c%84%ed%95%9c%20%eb%8d%b0%ec%9d%b4%ed%84%b0%20%ed%99%95%ec%9d%b8%20Query%eb%a5%bc%20%ec%8b%a4%ed%96%89%20%ec%9e%8a%ec%a7%80%20%ec%95%8a%ea%b3%a0%20%ec%a0%95%ed%95%b4%ec%a7%84%20%ec%9a%94%ec%9d%bc%ec%97%90%20%eb%b0%98%eb%b3%b5%20%ec%88%98%ed%96%89%20%20%ec%95%84%eb%a7%88%eb%8f%84%20%ea%b0%9c%eb%b0%9c%ec%9e%90%eb%8a%94%20%ec%9c%84%ec%99%80%20%ea%b0%99%ec%9d%80%20%eb%8b%a8%ea%b3%84%eb%a5%bc%20%eb%b0%98%eb%b3%b5%ec%a0%81%ec%9c%bc%eb%a1%9c%20%ec%88%98%ed%96%89%ed%95%98%ea%b2%8c%20%eb%90%a9%eb%8b%88%eb%8b%a4."><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&t=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#github-actions을-이용해서-db-데이터-업데이트하기>Github Actions을 이용해서 DB 데이터 업데이트하기</a></li><li><a href=#postgresql-db의-특정-컬럼의-데이터를-업데이트-하는-golang-code>Postgresql DB의 특정 컬럼의 데이터를 업데이트 하는 golang code</a></li><li><a href=#github-action에서-cron--build--execute-스크립트>Github Action에서 cron / build / execute 스크립트</a></li><li><a href=#환경정보는-secrets에-저장>환경정보는 secrets에 저장</a></li><li><a href=#결론>결론</a></li><li><a href=#참조>참조</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Github Action을 이용한 빌드 & 실행에서 패스워드 숨기기</h1><div class=meta><div class=postdate><time datetime="2020-09-03 14:35:00 +0900 +0900" itemprop=datePublished>2020-09-03</time></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/go rel=tag>go</a>
<a class=tag-link href=/tags/github rel=tag>github</a>
,
<a class=tag-link href=/tags/action rel=tag>action</a></div></div></header><div class=content itemprop=articleBody><h1 id=github-actions>Github Actions?</h1><p><img src=https://sh0seo.github.io/images/github-actions.png alt></p><p>Github에는 Actions라는 기능이 있습니다. Travis CI 처럼 소스코드를 이용해서 build, test, deploy 등의 기능을 수행할 수 있는 서비스입니다.</p><p>Github Actions을 이용하면 hugo blog 빌드 & 배포, cron을 이용한 반복적인 업무 자동화도 할 수 있습니다.</p><h2 id=github-actions을-이용해서-db-데이터-업데이트하기>Github Actions을 이용해서 DB 데이터 업데이트하기</h2><p>만약에 일주일에 한번씩 DB를 업데이트 해야하는 일이 있다고 가정합니다.</p><ol><li>사용하는 DB용 클라이언트를 실행</li><li>login/password로 로그인</li><li>업데이트 query를 수행하기 위한 데이터 확인</li><li>Query를 실행</li><li>잊지 않고 정해진 요일에 반복 수행</li></ol><p>아마도 개발자는 위와 같은 단계를 반복적으로 수행하게 됩니다. 잊지 않고 반복적으로 해야하는 것도 중요하지만 사람이 직접 수행하다보면 실수도 하기 마련입니다.</p><p>그렇다면 golang 과 Github Action을 이용하여 반복적인 업무를 수행하는 코드를 만들어 보도록 합시다. 동시에 DB 접속정보(id, password, ip)와 같이 민감한 정보는 Secret 기능을 이용하여 코드 상에서 보이지 않도록 해봅니다.</p><h2 id=postgresql-db의-특정-컬럼의-데이터를-업데이트-하는-golang-code>Postgresql DB의 특정 컬럼의 데이터를 업데이트 하는 golang code</h2><p>대상 DB는 Postgresql DB를 사용합니다. 다른 DB를 사용한다면 그에 맞는 패키지를 사용해야 합니다.</p><ul><li>MySQL: <a href=https://github.com/go-sql-driver/mysql>https://github.com/go-sql-driver/mysql</a></li><li>MSSQL: <a href=https://github.com/denisenkom/go-mssqldb>https://github.com/denisenkom/go-mssqldb</a></li><li>Oracle: <a href=https://github.com/rana/ora>https://github.com/rana/ora</a></li><li>Postgres: <a href=https://github.com/lib/pq>https://github.com/lib/pq</a></li><li>SQLite: <a href=https://github.com/mattn/go-sqlite3>https://github.com/mattn/go-sqlite3</a></li><li>DB2: <a href=https://bitbucket.org/phiggins/db2cli>https://bitbucket.org/phiggins/db2cli</a></li></ul><p>필요에 따라 ORM을 사용해도 되지만, simple한 query만 사용하기에 기본 패키지에 있는 database/sql를 사용합니다.
소스코드의 기능은 아래와 같습니다.</p><ol><li>환경변수에 등록된 정보를 읽어온다.</li><li>DB 접속 정보를 구성하여 접속한다.</li><li><code>SELECT 1</code> 테스트 query를 수행한다.</li><li>등록된 사용자인지 확인한다.</li><li>카드 번호를 hash 한 값을 DB에 업데이트 한다.</li></ol><pre><code>package main

import (
	&quot;crypto/sha256&quot;
	&quot;database/sql&quot;
	&quot;fmt&quot;
	&quot;os&quot;
	&quot;time&quot;

	_ &quot;github.com/lib/pq&quot;
)

func main() {
	fmt.Println(&quot;DCCafe User RFID Update&quot;)

	// input
	name := &quot;홍길동&quot;
	// input
	cardNumber := &quot;3255213734&quot;

	dbHost := os.Getenv(&quot;DB_HOST&quot;) // 로컬에서 개발 시에는 환경변수 DB_HOST에 등록
	dbPassword := os.Getenv(&quot;DB_PW&quot;) // 로컬에서 개발 시에는 환경변수 DB_PW에 패스워드 등록

	conn := &quot;user=dcadmin password=%s host=%s dbname=dcadmin sslmode=disable&quot;

	if len(name) == 0 {
		fmt.Printf(&quot;[Error] user empty\n&quot;)
		return
	}

	if len(cardNumber) == 0 {
		fmt.Printf(&quot;[Error] Card Number empty\n&quot;)
		return
	}

	if len(dbHost) == 0 {
		fmt.Printf(&quot;[Error] Not find DB HOST\n&quot;)
		return
	}

	if len(dbPassword) == 0 {
		fmt.Printf(&quot;[Error] Not find DB Password\n&quot;)
		return
	}

	db, err := sql.Open(&quot;postgres&quot;, fmt.Sprintf(conn, dbPassword, dbHost))
	if err != nil {
		panic(err)
	}
	defer db.Close()

	var status int
	err = db.QueryRow(&quot;SELECT 1&quot;).Scan(&amp;status)
	if err != nil {
		panic(err)
	}

	if status != 1 {
		panic(fmt.Sprintf(&quot;SELECT 1 is not %d\n&quot;, status))
	}

	// get User
	var user Users
	err = db.QueryRow(`SELECT email, rfid, company, index, name, leave, regdate, updatedate FROM users WHERE name = $1`, name).Scan(&amp;user.email, &amp;user.rfid, &amp;user.company, &amp;user.index, &amp;user.name, &amp;user.leave, &amp;user.regdate, &amp;user.updatedate)
	if err != nil {
		panic(err)
	}

	fmt.Printf(&quot;find user %s\n&quot;, user.name)

	rfid := hash(cardNumber)

	status = 0
	err = db.QueryRow(`SELECT 1 FROM users WHERE rfid = $1`, rfid).Scan(&amp;status)
	if err == nil {
		fmt.Printf(&quot;[Error] Exist Card Number:%s\n&quot;, cardNumber)
		return
	}

	fmt.Printf(&quot;Get new RFID %s\n&quot;, rfid)

	_, err = db.Exec(`UPDATE users SET rfid = $1, updatedate = now() WHERE index = $2`, rfid, user.index)
	if err != nil {
		panic(err)
	}

	fmt.Printf(&quot;Update User: %s, CardNumber: %s\n&quot;, user.name, cardNumber)
}

func hash(cardNumber string) string {
	sum := sha256.Sum256([]byte(cardNumber))
	return fmt.Sprintf(&quot;%x&quot;, sum)
}

// Users DB
type Users struct {
	email      string // PK
	rfid       string // PK
	company    string
	index      int
	name       string
	leave      bool
	regdate    time.Time
	updatedate time.Time
}
</code></pre><p>로컬에서 테스트하여 정상적으로 동작하는 소스코드는 gihub 프로젝트에 push 합니다.</p><h2 id=github-action에서-cron--build--execute-스크립트>Github Action에서 cron / build / execute 스크립트</h2><p>자동 실행을 위한 Github Action용 스크립트를 작성합니다.
Github Action을 사용하기 위해서는 아래의 위치에 yml로 작성한 스크립트가 필요합니다.</p><pre><code>github-프로젝트-root/.github/workflows/main.yml
</code></pre><p>스크립트는 수행 시점을 정의하는 <code>on</code>과 수행해야하는 것(환경구성, 소스코드 실행)을 정의하는 <code>job</code>로 구분됩니다.</p><p>아래와 같이 <code>on</code>을 정의하면 두가지 조건을 설정할 수 있습니다.</p><ul><li><code>master</code> 브런치에 push가 되면 스크립트를 실행</li><li>일요일 0시에 스크립트를 실행</li></ul><pre><code>on:
  push:
    branches: [ master ]
  schedule:
    - cron:  '0 9 * * SUN'
</code></pre><p>그리고 Github Action 스크립트는 소스코드와 달리 github site에서 직접 수정하는 것이 도움이 됩니다. github site의 에디터에서 직접 수정을 하면 cron의 경우 아래와 같이 시간에 대한 정보를 확인할 수 있습니다.</p><p><img src=https://sh0seo.github.io/images/cron-preview.png alt></p><p>전체 스크립트는 아래와 같습니다.</p><pre><code>name: update

on:
  push:
    branches: [ master ]
  schedule:
    - cron:  '0 9 * * SUN'
      
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2.3.2
      with:
        ref: &quot;master&quot;
    
    - name: go setup
      uses: actions/setup-go@v2.1.2
      with:
        go-version: &quot;1.13&quot;
    
    - name: pg driver
      run: |
        go get github.com/lib/pq
    - name: run 
      run: |
        go run main.go
      env:
        DB_HOST: ${{ secrets.DB_HOST}}
        DB_PW: ${{ secrets.DB_PW}}
</code></pre><h2 id=환경정보는-secrets에-저장>환경정보는 secrets에 저장</h2><p>소스코드를 실행하기 위해 필요한 DB 접속정보는 공개되면 안되기 때문에 환경설정에서 읽어서 처리하도록 합니다. Github Action에서 환경설정에 특정 값을 설정하기 위해서는 <code>env</code>에 설정을 합니다. 아래 스크립트의 의미는 secrets.DB_HOST에 설정된 값을 DB_HOST 환경변수에 저장하겠다는 의미입니다.</p><pre><code>      env:
        DB_HOST: ${{ secrets.DB_HOST}}
        DB_PW: ${{ secrets.DB_PW}}
</code></pre><p>그렇다면 <code>${{ secrets.XXXXX }}</code> 값은 어디에서 설정하면 될까요? github의 해당 프로젝트의 setting 에서 관리할 수 있습니다.</p><p><img src=https://sh0seo.github.io/images/secrets-value.png alt></p><h2 id=결론>결론</h2><p>Github Action 기능을 이용하여 golang 소스코드를 실행하는 기능을 만들었습니다. Travis CI에서 처리했던것 보다는 좀 더 github 친화적이라서 사용하기도 편하고, 특별한 서버 없이도 수행할 수 있는 장점이 있습니다. 저 같은 경우는 cron 기능, DB 업데이트 등을 모두 golang + github action으로 처리하고 있습니다. 좋은 기능은 역시 자주 사용해서 잊어먹지 않아야하고 이렇게 공유해야 합니다. ^^;</p><h2 id=참조>참조</h2><ul><li><a href=http://golang.site/go/article/106-SQL-DB-%ED%99%9C%EC%9A%A9>Golang DB Package</a></li><li><a href="https://pkg.go.dev/database/sql?tab=doc">Golang sql</a></li><li><a href=https://docs.github.com/en/actions>Github Action</a></li></ul></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about/>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#github-actions을-이용해서-db-데이터-업데이트하기>Github Actions을 이용해서 DB 데이터 업데이트하기</a></li><li><a href=#postgresql-db의-특정-컬럼의-데이터를-업데이트-하는-golang-code>Postgresql DB의 특정 컬럼의 데이터를 업데이트 하는 golang code</a></li><li><a href=#github-action에서-cron--build--execute-스크립트>Github Action에서 cron / build / execute 스크립트</a></li><li><a href=#환경정보는-secrets에-저장>환경정보는 secrets에 저장</a></li><li><a href=#결론>결론</a></li><li><a href=#참조>참조</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&text=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&is_video=false&description=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0&body=Check out this article: https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&title=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&name=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0&description=Github%20Actions%3f%20Github%ec%97%90%eb%8a%94%20Actions%eb%9d%bc%eb%8a%94%20%ea%b8%b0%eb%8a%a5%ec%9d%b4%20%ec%9e%88%ec%8a%b5%eb%8b%88%eb%8b%a4.%20Travis%20CI%20%ec%b2%98%eb%9f%bc%20%ec%86%8c%ec%8a%a4%ec%bd%94%eb%93%9c%eb%a5%bc%20%ec%9d%b4%ec%9a%a9%ed%95%b4%ec%84%9c%20build%2c%20test%2c%20deploy%20%eb%93%b1%ec%9d%98%20%ea%b8%b0%eb%8a%a5%ec%9d%84%20%ec%88%98%ed%96%89%ed%95%a0%20%ec%88%98%20%ec%9e%88%eb%8a%94%20%ec%84%9c%eb%b9%84%ec%8a%a4%ec%9e%85%eb%8b%88%eb%8b%a4.%0aGithub%20Actions%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%98%eb%a9%b4%20hugo%20blog%20%eb%b9%8c%eb%93%9c%20%26amp%3b%20%eb%b0%b0%ed%8f%ac%2c%20cron%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b0%98%eb%b3%b5%ec%a0%81%ec%9d%b8%20%ec%97%85%eb%ac%b4%20%ec%9e%90%eb%8f%99%ed%99%94%eb%8f%84%20%ed%95%a0%20%ec%88%98%20%ec%9e%88%ec%8a%b5%eb%8b%88%eb%8b%a4.%0aGithub%20Actions%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%b4%ec%84%9c%20DB%20%eb%8d%b0%ec%9d%b4%ed%84%b0%20%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8%ed%95%98%ea%b8%b0%20%eb%a7%8c%ec%95%bd%ec%97%90%20%ec%9d%bc%ec%a3%bc%ec%9d%bc%ec%97%90%20%ed%95%9c%eb%b2%88%ec%94%a9%20DB%eb%a5%bc%20%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8%20%ed%95%b4%ec%95%bc%ed%95%98%eb%8a%94%20%ec%9d%bc%ec%9d%b4%20%ec%9e%88%eb%8b%a4%ea%b3%a0%20%ea%b0%80%ec%a0%95%ed%95%a9%eb%8b%88%eb%8b%a4.%0a%20%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94%20DB%ec%9a%a9%20%ed%81%b4%eb%9d%bc%ec%9d%b4%ec%96%b8%ed%8a%b8%eb%a5%bc%20%ec%8b%a4%ed%96%89%20login%2fpassword%eb%a1%9c%20%eb%a1%9c%ea%b7%b8%ec%9d%b8%20%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8%20query%eb%a5%bc%20%ec%88%98%ed%96%89%ed%95%98%ea%b8%b0%20%ec%9c%84%ed%95%9c%20%eb%8d%b0%ec%9d%b4%ed%84%b0%20%ed%99%95%ec%9d%b8%20Query%eb%a5%bc%20%ec%8b%a4%ed%96%89%20%ec%9e%8a%ec%a7%80%20%ec%95%8a%ea%b3%a0%20%ec%a0%95%ed%95%b4%ec%a7%84%20%ec%9a%94%ec%9d%bc%ec%97%90%20%eb%b0%98%eb%b3%b5%20%ec%88%98%ed%96%89%20%20%ec%95%84%eb%a7%88%eb%8f%84%20%ea%b0%9c%eb%b0%9c%ec%9e%90%eb%8a%94%20%ec%9c%84%ec%99%80%20%ea%b0%99%ec%9d%80%20%eb%8b%a8%ea%b3%84%eb%a5%bc%20%eb%b0%98%eb%b3%b5%ec%a0%81%ec%9c%bc%eb%a1%9c%20%ec%88%98%ed%96%89%ed%95%98%ea%b2%8c%20%eb%90%a9%eb%8b%88%eb%8b%a4."><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsh0seo.github.io%2fposts%2f2020-09-03-password-in-github-action%2f&t=Github%20Action%ec%9d%84%20%ec%9d%b4%ec%9a%a9%ed%95%9c%20%eb%b9%8c%eb%93%9c%20%26%20%ec%8b%a4%ed%96%89%ec%97%90%ec%84%9c%20%ed%8c%a8%ec%8a%a4%ec%9b%8c%eb%93%9c%20%ec%88%a8%ea%b8%b0%ea%b8%b0"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><script src=https://utteranc.es/client.js repo=sh0seo/sh0seo.github.io issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script><footer id=footer><div class=footer-left>Copyright &copy; 2020 sh0seo</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about/>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>